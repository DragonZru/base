mode:
  type: Standalone
  repository:
    type: JDBC

dataSources:
  ds_0:
    dataSourceClassName: com.zaxxer.hikari.HikariDataSource
    driverClassName: com.mysql.cj.jdbc.Driver
    jdbcUrl: "jdbc:mysql://127.0.0.1:3306/base-1?useUnicode=true&useJDBCCompliantTimezoneShift=true&serverTimezone=Asia/Shanghai"
    username: root
    password: 123456
  ds_1:
    dataSourceClassName: com.zaxxer.hikari.HikariDataSource
    driverClassName: com.mysql.cj.jdbc.Driver
    jdbcUrl: "jdbc:mysql://127.0.0.1:3306/base-2?useUnicode=true&useJDBCCompliantTimezoneShift=true&serverTimezone=Asia/Shanghai"
    username: root
    password: 123456

rules:
- !BROADCAST
  tables:
    - t_config
- !SHARDING
  tables:
    t_example:
      actualDataNodes: ds_${0..1}.t_example_${0..9}
      databaseStrategy:
        standard:
          shardingColumn: username
          shardingAlgorithmName: database_inline
      tableStrategy:
        standard:
          shardingColumn: id
          shardingAlgorithmName: t_example_inline
      keyGenerateStrategy:
        column: id
        keyGeneratorName: leaf
  defaultDatabaseStrategy:
    none:
#  autoTables:
#    t_example_auto:
#      actualDataSources: ds_${0..1}
#      shardingStrategy:
#        standard:
#          shardingColumn: username
#          shardingAlgorithmName: database_hash_mod
  shardingAlgorithms:
    database_hash_mod:
      type: HASH_MOD
      props:
        sharding-count: 2
    database_inline:
      type: INLINE
      props:
        algorithm-expression: ds_${id % 2}
    t_example_inline:
      type: INLINE
      props:
        algorithm-expression: t_example_${id % 10}
  keyGenerators:
    snowflake:
      type: SNOWFLAKE
    leaf:
      type: LeafGenerator
      props:
        uri: http://127.0.0.1:18080/leaf?bizTag=${spring.application.name}

props:
  sql-show: false

transaction:
  defaultType: BASE
  providerType: Seata
